\section{Introduction}
    An essential trait of a living system is its ability to reproduce.
    This fundamental ability makes all living systems autocatalytic by definition.
    It then follows that any essential component of a living system is autocatalytic, as it is required for reproduction, that leads to duplication of that component.
    Specifically, the metabolic system of any living organism, composed of the intermediate metabolites and enzymes catalyzing its reactions, is autocatalytic as a whole and must enable both the excess production of each of its metabolites, as well as the production of all the precursor molecules needed in order for the translation-transcription machinery to synthesize new copies of its enzymes.
    Autocatalytic systems have an inherent potential to be unstable as their operation changes the amount of their components.

    Even though the whole metabolic system of an organism is part of the autocatalytic process of reproduction, this does not imply that it is composed of smaller autocatalytic components.
    The metabolic system is composed of two classes of components, enzymes and metabolites.
    Clearly, the metabolic system by itself is not autocatalytic with respect to enzymes, as it lacks the transcription-translation machinery needed to produce them.
    Regarding metabolites, it is not a priory evident that the metabolic system needs to be autocatalytic with respect to them.
    Theoretically, all the intermediate metabolites of a metabolic system could be generated directly from external nutrients, not requiring existing internal metabolite pools.
    However, and despite the essentiality of functioning metabolic networks, such networks often do require the availability of certain intermediate metabolites, in addition to the nutrients consumed, in order to function.
    The most common example of obligatorily autocatalytic internal metabolites is co-factors \cite{Kun2008-xg}.
    The requirement for availability of certain metabolites in order to consume nutrients implies metabolic processes must be finely controlled to prevent such essential metabolites from running out, as in such cases metabolism will stop and the organism will die.
    Therefore, from a robustness point of view, autocatalytic cycles seem to be a weakness in metabolism.
    On the other hand, autocatalytic cycles are, in specific cases, optimal network topologies that minimize the number of reactions needed for the production of precursor molecules from different nutrients \cite{Riehl2010-yh}.

    In this work we focus on autocatalytic cycles in chemical reaction systems, and specifically in metabolic networks.
    The components we consider are the metabolites of the system, with autocatalytic cycles being formed using the reactions of the metabolic network.
    An illustrative example for a metabolic autocatalytic cycle is glycolysis.
    In glycolysis, 2 ATP molecules are consumed in the priming phase, in order to produce 4 ATP molecules in the pay off phase.
    Therefore, in order to produce ATP in glycolysis, ATP must already be present in the cell.
    We show that stable operation of autocatalytic cycles dictates constraints on kinetic parameters of participating enzymes.

    Metabolic autocatalytic cycles present control challenges as their inherent feed-back nature makes them susceptible to instabilities such as divergence or drainage of their intermediate metabolites \cite{Fell1999,Reznik2010-te}.
    The stability criteria typically represent one constraint among the parameters of the cycle enzymes.
    For large cycles, such as the whole metabolic network, one such constraint adds little information.
    For compact autocatalytic cycles embedded within metabolism, one such constraint is much more meaningful.
    We thus focus our efforts at analyzing small autocatalytic cycles.
    Understanding the unique constraints that metabolic autocatalytic cycles impose is essential for realizing limitations of existing metabolic networks, as well as for modifying them in synthetic biology and metabolic engineering applications.

    The importance of autocatalytic cycles in metabolism is demonstrated by one of its most prominent examples, the Calvin-Benson-Bassham cycle (CBB) \cite{Benson1950-cl}.
    The carbon fixation CBB cycle, fixing \ce{CO2} while transforming 5-carbon compounds to two 3-carbon compounds, serves as the main gateway for converting inorganic carbon to organic compounds in nature \cite{Raven2012-le}.
    The autocatalytic nature of the CBB cycle stems from the fact that for every five 5-carbon compounds the cycle consumes, six 5-carbon compounds are produced.
    Beyond the CBB cycle, we show that most of the reactions and metabolites in central carbon metabolism are part of compact (i.e. consisting of around 10 reactions or less) metabolic autocatalytic cycles.
    Some of the autocatalytic cycles we find are not usually considered as such.
    The wide span of autocatalytic cycles in central carbon metabolism suggests that the constraints underlying their stable operation have network-wide biological consequences.

    In this study we present the specific requirements metabolic autocatalytic cycles must meet in order to achieve at least one, non-zero, steady state and be stable in respect to fluctuations of metabolites or levels of enzymes close to the steady state point.
    The mathematical tools we use are part of dynamical systems theory \cite{Strogatz2014-hp}.
    We identify the kinetic parameters of enzymes at metabolic branch points out of an autocatalytic cycle as critical values that determine whether the cycle can stably operate.
    We show that the affinity of enzymes consuming intermediate metabolites of autocatalytic cycles must be limited to prevent drainage of these metabolites.
    Moreover, we show that stable operation of such cycles requires excess expression of these enzymes, resulting in a seemingly inefficient expression pattern that does not utilize the full catalytic capacity of such enzymes.
    We point that, for enzymes consuming intermediate metabolites of autocatalytic cycles, there is a reverse relationship between the affinity of the enzyme and the flux it carries.
    Therefore, for these enzymes, the lower the affinity to the substrate is, the higher the flux the reaction will carry, which is opposite to the normal relationship between affinities and fluxes.
    We use recent fluxomics and proteomics data to test these design principles.
    We find them to hold in cases at which autocatalytic cycles support flux.
    Our analysis demonstrates how the requirement for stable operation of autocatalytic cycles results in design principles that are followed by autocatalytic cycles in-vivo.
    The results and design principles presented here can further be used in synthetic metabolic engineering applications that require proper functioning of autocatalytic cycles.

\section{Results}
\subsection{Autocatalytic cycles play important roles in central carbon metabolism}
Different definitions exist for autocatalytic sets in the context of chemical reaction networks \cite{Hordijk2004-xe, Eigen2012-ti, Kun2008-xg}.
Here we define an autocatalytic cycle as a set of reactions and metabolites that form a cycle, and that, when the reactions are applied to the substrates at appropriate ratios, increase the amount of the intermediate metabolites.
A simple example of a metabolic autocatalytic cycle is shown in Figure \ref{fig:autocataldef}, where an internal metabolite joins with an external assimilated metabolite to give rise to $1+\gamma$ copies of the internal metabolite, representing an increase by $\gamma$ copies.
For stable operation, $\gamma$ copies have to branch out of the cycle, and this consumption must be robust to small fluctuations in enzyme levels and metabolite concentrations.
For a formal, mathematical definition, see the methods section.

\begin{figure}[!htb]
    \centering{
        \input{autocatalytic-cycle.tex}}
\caption{
    \label{fig:autocataldef}
  A basic autocatalytic cycle requires an internal metabolite to be present in order to assimilate the external metabolite into the cycle, increasing the amount of the internal metabolite by some amount, $\gamma$.}
\end{figure}
 
While rarely discussed as such, a systematic search in central carbon metabolism of \emph{E.coli} (see methods) shows the ubiquity of autocatalytic cycles.
On top of the previously discussed CBB cycle (Figure \ref{fig:realautocatal}, example I), we show two other prominent examples:
\begin{itemize}
    \item The glyoxylate cycle within the TCA cycle, which turns an internal malate and two external acetyl CoA's into two malate molecules.
        This is achieved by transforming malate to isocitrate, while assimilating acetyl CoA, and then splitting the isocitrate to produce two malate molecules, assimilating another acetyl-CoA \cite{Kornberg1966-lh} (Figure \ref{fig:realautocatal}, example II).
    \item A widely known feature in bacteria that import a glucose molecule using phosphoenolpyruvate (PEP) as a co-factor, and then produce two PEP molecules via glycolysis.
        This autocatalytic cycle therefore consumes PEP to transport sugar substrates using the phosphotransferase system (PTS), then converts the imported substrate into two PEP molecules (Figure \ref{fig:realautocatal}, example III).

\end{itemize}
Two additional examples are presented in Figures \ref{fig:extrasamps1} and \ref{fig:extrasamps2} and discussed below.

The ubiquity of compact autocatalytic cycles in central carbon metabolism suggests that unique features of autocatalytic cycles, as derived below, may constrain and shape the kinetic parameters of a broad set of enzymes at the heart of metabolism.

\begin{figure}[!htb]
\resizebox{1\linewidth}{!}{
  \input{autocatalytic-samples.tex}
}
\caption{
    \label{fig:realautocatal}
Three representative autocatalytic cycles in central carbon metabolism: (I) The Calvin-Benson-Bassham cycle (yellow); (II) The glyoxylate cycle (magenta); (III) A cycle using the PTS system to assimilate glucose (cyan).
Assimilation reactions are indicated in green.
Arrow width in panels represent relative carbon mass.
}
\end{figure}

\subsection{Steady state existence and stability analysis of a simple autocatalytic cycle}
To explore general principles governing the dynamic behavior of autocatalytic cycles, we consider the simple autocatalytic cycle depicted in Figure \ref{fig:simplecycle}A.
This cycle has a single intermediate metabolite, $X$.
We denote the flux through the autocatalytic reaction of the cycle by $f_a$, such that for any unit of $X$ consumed, it produces two units of $X$.
The autocatalytic reaction assimilates an external metabolite (denoted $A$), which we assume to be at a constant concentration.
We denote the flux through the reaction branching out of the cycle by $f_b$.
For simplicity in the derivation, we assume irreversible Michaelis-Menten kinetics for the two reactions such that:
    \begin{eqnarray*}
      f_a = \frac{V_{\max,a}X}{K_{M,a}+X} \\
      f_b = \frac{V_{\max,b}X}{K_{M,b}+X}
    \end{eqnarray*}
    where $V_{\max}$ is the maximal flux each reaction can carry and $K_M$ is the substrate concentration at which half the maximal flux is attained.
    Physiologically, these kinetic parameters must be positive.
    Using these simple forms allows us to obtain an analytic solution.
    We discuss more general cases below.
    \begin{figure}[!htb]
      \input{simple-cycle-analysis-figure.tex}
      \caption{\label{fig:simplecycle}
        (A) A simple autocatalytic cycle induces two fluxes, $f_a$ and $f_b$ as a function of the concentration of $X$.
        These fluxes follow simple Michaelis Menten kinetics.
        A steady state occurs when $f_a=f_b$, implying that $\dot{X}=0$.
        The cycle always has a steady state at $X=0$.
        The slope of each reaction at $X=0$ is $\sfrac{V_{\max}}{K_m}$.
        A steady state is stable if at the steady state concentration $\frac{d\dot{X}}{dX}<0$.
        (B) Each set of kinetic parameters, $V_{\max,a},V_{\max,b},K_{M,a},K_{M,b}$ determines two characteristics of the system: 
        If $V_{\max,b}>V_{\max,a}$, then a stable steady state concentration must exist as for high concentrations of $X$ the branching reaction will reduce its concentration (cyan domain, cases (I) and (II)).
        If $\sfrac{V_{\max,b}}{K_{M,b}}<\sfrac{V_{\max,a}}{K_{M,a}}$, implying that $\sfrac{V_{\max,b}}{V_{\max,a}}<\sfrac{K_{M,b}}{K_{M,a}}$, then zero is a non-stable steady state concentration as if $X$ is slightly higher than zero, the autocatalytic reaction will carry higher flux, further increasing the concentration of $X$ (magenta domain, cases (I) and (IV)).
    At the intersection of these two domains a non-zero, stable steady state concentration exists (I).}
    \end{figure}

    We characterize the metabolic state of this system by the concentration of the metabolite $X$.
    We note that knowing the concentration of $X$ suffices in order to calculate the fluxes originating from it, $f_a$ and $f_b$, thus fully defining the state of the system.
    A steady state of the system is defined as a concentration, $X^*$, which induces fluxes that keep the concentration constant, such that the total in-flux to $X$ is exactly equal to the total out-flux from it.
    In our example, the outgoing flux from $X$ is $f_a+f_b$ and the incoming flux to $X$ is $2f_a$, so at steady state it holds that:
    \begin{equation}
      \label{eq:xdyna}
      \dot X = \frac{dX}{dt} = 2f_a - (f_a + f_b) = 0
    \end{equation}

    Intuitively, at steady state, the branch reaction must consume all the excess intermediate metabolite that is produced by the autocatalytic reaction.
    Indeed, expanding the condition above gives:
    \begin{equation*}
      f_a = f_b \Rightarrow \frac{V_{\max,a}X}{K_{M,a}+X}=\frac{V_{\max,b}X}{K_{M,b}+X}
    \end{equation*}
    which is satisfied either if $X=0$ or if:
    \begin{equation}
      \label{eq:xstst}
      X=\frac{V_{\max,b}K_{M,a}-V_{\max,a}K_{M,b}}{V_{\max,a}-V_{\max,b}}
    \end{equation}
    The concentration of $X$ cannot be negative, and thus we get a constraint on the kinetic parameters for which a positive steady state exists:
    \begin{equation*}
      \frac{V_{\max,b}K_{M,a}-V_{\max,a}K_{M,b}}{V_{\max,a}-V_{\max,b}}>0 \Rightarrow \frac{\frac{V_{\max,b}}{K_{M,b}}-\frac{V_{\max,a}}{K_{M,a}}}{V_{\max,a}-V_{\max,b}}>0
    \end{equation*}
    In order to gain intuition for this relationship we note that $\frac{V_{\max}}{K_m}$ is the slope of the Michaelis Menten function at $X=0$.
    The constraint therefore implies that in order for a positive steady state to exist, the reaction with higher maximal flux must have a shallower slope at $X=0$.
    Mathematically, the constraint states that if $V_{\max,b}<V_{\max,a}$ then $\frac{V_{\max,b}}{K_{M,b}}>\frac{V_{\max,a}}{K_{M,a}}$.
    Alternatively, if $V_{\max,b}>V_{\max,a}$ then $\frac{V_{\max,b}}{K_{M,b}}<\frac{V_{\max,a}}{K_{M,a}}$.
    This condition can be intuitively understood, as the reaction with shallower slope at $X=0$ has smaller fluxes for small values of $X$, compared with the other reaction, so unless it has higher fluxes than the other reaction for large values of $X$ (meaning that its maximal flux is higher), the two will never intersect, which is the condition for a steady state.
    This constraint is graphically illustrated in Figure \ref{fig:simplecycle}B, cases (I) and (III).

    While having a positive concentration steady state is an essential condition to sustain flux, it is not sufficient in terms of biological function.
    The positive concentration steady state must also be stable to small perturbations.
    Stability with respect to small perturbations is determined by the response of the system to small deviations from the steady state, $X^*$.
    Mathematically, stability dictates that at $X=X^*$ it holds that $\frac{d\dot X}{dX} <0$, as this  implies that upon a small deviation from the steady state: $X = X^*+\Delta X$ the net flux $\dot X$ will oppose the direction of the deviation.
    If $\Delta X$ is positive then $\dot X$ will be negative at $X^*+\Delta X$, reducing $X$ back to $X^*$, and if $\Delta X$ is negative, $\dot X$ will be positive, increasing $X$ back to $X^*$.

    For the simple kinetics we chose the stability condition dictates that:
    \begin{equation}
        \label{eq:stable}
      \frac{d\dot X}{dX}\Big\vert_{X^*} = \frac{V_{\max,a}K_{M,a}}{(K_{M,a}+X^*)^2}-\frac{V_{\max,b}K_{M,b}}{(K_{M,b}+X^*)^2}<0
    \end{equation}
    The analysis is straightforward for the case of $X^*=0$, yielding that $0$ is a stable steady state concentration if $\frac{V_{\max,b}}{K_{M,b}}>\frac{V_{\max,a}}{K_{M,a}}$, corresponding to the area above the diagonal in figure \ref{fig:simplecycle}B, where $\frac{V_{\max,b}}{V_{\max,a}}>\frac{K_{M,b}}{K_{M,a}}$. These cases are denoted as cases (II) and (III).
    If the relation is reversed (i.e. $\frac{V_{\max,b}}{K_{M,b}}<\frac{V_{\max,a}}{K_{M,a}}$), then $0$ is an unstable steady state.
    The criterion that is of interest, however, is the criterion for stability of the non-zero steady state, $X^*=\frac{V_{\max,b}K_{M,a}-V_{\max,a}K_{M,b}}{V_{\max,a}-V_{\max,b}}$.
    In this case, substituting $X^*$ in equation \ref{eq:stable} gives the opposite condition to that of $X^*=0$.
    This steady state is thus stable if $\frac{V_{\max,b}}{K_{M,b}}<\frac{V_{\max,a}}{K_{M,a}}$, corresponding to the magenta domain in figure \ref{fig:simplecycle}B, containing cases (I) and (IV), and unstable otherwise.

    The stability criterion can be generally stated in metabolic control terms \cite{Fell1997-bp} using the notion of elasticity coefficients of reactions, defined as:
    \begin{equation*}
    \varepsilon^f_X=\frac{\partial f}{\partial X}\frac{X}{f}
    \end{equation*}
    In these terms, stability is obtained if and only if the elasticity of the branch reaction at the positive steady state concentration is greater than the elasticity of the autocatalytic reaction:
    \begin{equation*}
        \frac{df_b}{dX}\Big\vert_{X^*}>\frac{df_a}{dX}\Big\vert_{X^*} \Rightarrow \varepsilon^{f_b}_X>\varepsilon^{f_a}_X
    \end{equation*}
    
    The complete analysis is summarized up in Figure \ref{fig:simplecycle}B.
    Domain (I) is the only domain where a positive, stable steady state exists.
    Domains (I) and (III) are the domains at which a positive steady state concentration exists, but in domain (III) that steady state is not stable.
    The domains below the diagonal (cases (I) and (IV)) are the domains where $X^*=0$ is an unstable steady state concentration, so that if another steady state exists, it is stable, but in domain (IV) no positive steady state exists.
    The domains above the diagonal (cases (II) and (III)) are the domains where $X^*=0$ is a stable steady state concentration, so that the other steady state, if it exists, is unstable.

    Aside from existence and stability, a quantitative relationship between the affinity of the biomass generating, branching reaction and the flux it carries can be obtained.
    This relationship is reverse to the standard one, meaning that unlike the common case where $f\propto\frac{1}{K_M}$, in this case, when substituting the steady state concentration from Equation \ref{eq:xstst} into the flux equation for $f_b$, we get that:

    \begin{equation*}
        f_b=\frac{V_{\max,b}X}{K_{M,b}+X}=\frac{V_{\max,b}\frac{V_{\max,b}K_{M,a}-V_{\max,a}K_{M,b}}{V_{\max,a}-V_{\max,b}}}{K_{M,b}+\frac{V_{\max,b}K_{M,a}-V_{\max,a}K_{M,b}}{V_{\max,a}-V_{\max,b}}}=\frac{V_{\max,b}K_{M,a}-V_{\max,a}K_{M,b}}{K_{M,a}-K_{M,b}}
    \end{equation*}
    which, for $K_{M,b}$ that satisfies the existence and stability conditions such that $\frac{V_{\max,b}}{K_{M,b}}<\frac{V_{\max,a}}{K_{M,a}}$, results in $f_b \propto K_{M,b}$.

    To conclude, for this simple cycle, we get that in order for a positive-concentration stable steady state to exist (case (I)), two conditions must be satisfied:
    \begin{equation}
    \label{eq:stabconds}
    \begin{dcases}
      & V_{\max,b}>V_{\max,a} \\
      & \frac{V_{\max,b}}{K_{M,b}}<\frac{V_{\max,a}}{K_{M,a}}
    \end{dcases}
    \end{equation}
    The first requirement states that the maximal flux of the biomass generating, branching reaction should be higher than the maximal flux of the autocatalytic reaction.
    This requirement ensures a stable solution exists, as large concentrations of $X$ will result in its reduction by the branching reaction.
    The second requirement states that at low concentrations of $X$, the autocatalytic reaction starts higher than the branch reaction (as can be inferred from the slopes).
    This requirement implies that the two fluxes will be equal for some positive concentration of $X$, ensuring a positive steady state exists.
    As this requirement further implies that below the positive steady state the branch reaction will carry less flux than the autocatalytic reaction, it follows that small deviations of the concentration of $X$ below the steady state will result in an increase in its concentration by the autocatalytic reaction, driving it back to the steady state.
    Meeting the second constraint has another consequence.
    Unlike the common case where higher affinity of an enzyme increases the flux through the reaction it catalyzes, in autocatalytic cycles, higher affinity of the branch reaction reduces the flux it carries due to reduction in the steady state concentration of the intermediate metabolite of the cycle.

    Interestingly, these conditions imply that if $K_{M,b}<K_{M,a}$ then no positive stable steady state can be achieved.
    Specifically, changes to the expression levels of the enzymes catalyzing $f_a$ and $f_b$ only affect $V_{\max,a}$ and $V_{\max,b}$, and therefore do not suffice to attain a stable positive steady state.
    This indicates that stability of autocatalytic cycles depends on inherent kinetic properties of the enzymes involved and cannot always be achieved by modulating expression levels, a design principle that may be critical in metabolic engineering context.
\subsection{Extensions of the simple autocatalytic cycle model}
    \subsubsection{Generalizing for different autocatalytic stoichiometries}
    Our didactic exemplary analysis considered an autocatalytic reaction with $1:2$ stoichiometry, such that for every substrate molecule consumed, two are produced.
    Real-world autocatalytic cycles may have different stoichiometries.
    For example, the CBB cycle has a stoichiometry of $5:6$ so that for every five molecules of 5-carbon sugars that the autocatalytic reaction consumes, six 5-carbon sugars are produced.
    We can generalize our analysis by defining a positive $\gamma$ such that for every molecule of $X$ that $f_a$ consumes, it produces $1+\gamma$ molecules of $X$, where $\gamma$ may be a fraction.
    This extension implies that equation \eqref{eq:xdyna} becomes:

    \begin{equation*}
      \dot X = \frac{dX}{dt} = (1+\gamma)f_a - (f_a + f_b) = 0 \Rightarrow \gamma f_a = f_b \Rightarrow \frac{\gamma V_{\max,a}X}{K_{M,a}+X}=\frac{V_{\max,b}X}{K_{M,b}+X}
    \end{equation*}

    Therefore, all of the results above can be extended to different stoichiometries by replacing $V_{\max,a}$ with $\gamma V_{\max,a}$.
    As a result, the qualitative conditions and observations from the $1:2$ stoichiometry case remain valid but with a constant factor that changes the quantitative relations according to the relevant stoichiometry.
\subsubsection{Input flux increases the range of parameters for which a stable steady state solution exists}
    Autocatalytic cycles are embedded within a larger metabolic network.
    Specifically, such cycles may have independent input fluxes to some of their intermediate metabolites, not requiring the use of other intermediate metabolites of the cycle.
    For example, in the glucose based, PTS-dependent autocatalytic cycle, the existence of alternative transporters can generate flux of glucose 6-phosphate into the cycle without the use of PEP \cite{Ferenci1996-nv}.

    When adding a constant input flux, $f_i$ to our simple system (Figure \ref{fig:inputcycle}A) the steady state condition changes to include this flux, giving:
    \begin{equation*}
      \dot X = \frac{dX}{dt} = f_i + f_a - f_b = 0
    \end{equation*}
    In this situation, at $X=0$, $\dot X=f_i>0$ so the concentration of $X$ increases and there is no steady state at zero.
    If $V_{\max,b}>f_i+V_{\max,a}$ then at a large enough value of $X$, $\dot X$ will be negative, implying that at some value of $X$ between these two extremes, $\dot{X}$ attains the value of zero, such that under this condition a positive stable steady state concentration exists (Figure \ref{fig:inputcycle} (I)).
    This case therefore differs from the case with no input flux analyzed above, as now a positive stable steady state can always be achieved by modifying only $V_{\max,a}$ and/or $V_{\max,b}$.
    In this setup, cells can therefore tune the expression levels of enzymes to meet the needs of a stable steady state flux.

    \begin{figure}[!htb]
        \centering{
            \input{autocatalytic-with-input.tex}}
      \caption{\label{fig:inputcycle}
        (A) A simple autocatalytic cycle with a fixed input flux, $f_i$.
        A steady state occurs when $f_a+f_i=f_b$.
        If $V_{\max,b}>V_{\max,a}+f_i$ then there is always a single stable steady state (I).
        If $V_{\max,b}<V_{\max,a}+f_i$ then there can either be no steady states (II), or two steady states where the smaller one is stable (III).
      }
    \end{figure}

    In cases where $V_{\max,b}<f_i+V_{\max,a}$ either no steady states exist (Figure \ref{fig:inputcycle} (II)), or two positive steady states exist (Figure \ref{fig:inputcycle} (III)).
    The latter case implies that there exists a positive concentration $X$ that satisfies:
    \begin{equation*}
        \dot X = 0 \Rightarrow f_i + f_a(X) - f_b(X) = 0 \Rightarrow f_i+\frac{V_{\max,a}X}{K_{M,a}+X} = \frac{V_{\max,b}X}{K_{M,b}+X}
    \end{equation*}
  In this case, the lower concentration steady state will be stable.

  To conclude, input fluxes change the steady state(s) of autocatalytic cycles.
  When an input flux is present, an autocatalytic cycle can always achieve a non zero, stable steady state by tuning the expression levels of the enzymes forming the cycle.

  Interestingly, we find that in the two autocatalytic cycles shown in figures \ref{fig:extrasamps1} and \ref{fig:extrasamps2}, reactions that generate direct input flux into the cycle exist.
  In the ribose-5P assimilating autocatalytic cycle (Figure \ref{fig:extrasamps1}), the rpi reaction serves as a shortcut, allowing input flux directly from ribose-5P into the cycle.
  In the glycerone-phosphate assimilating cycle (Figure \ref{fig:extrasamps2}), the tpi reaction similarly serves as such a shortcut.
  In these two cases, these shortcuts relax the constraints imposed by strict use of the corresponding autocatalytic cycles as they prevent zero from being a stable steady state concentration.
    Another example of the effects of addition of an input flux to an autocatalytic cycle is the input flux of fructose-6-phosphate from the catabolism of starch into the CBB cycle.
    This input flux can be used to 'kick start' the cycle without using the intermediate metabolites of the cycle.
    \subsubsection{Stability analysis for multiple-reaction cycles}
    It is useful to extend the simple criteria we derived to more complex autocatalytic cycles.
    In such cycles the criteria for existence of a steady state become complex and detail specific.
    We therefore focus on evaluating stability of such cycles, under the assumption that a non-zero steady state exists, which is often known from experimental measurements.
    The most straightforward extension is for cycles with more than one intermediate metabolite.

    We start by writing the relevant equations for the two-metabolite autocatalytic cycle depicted in figure \ref{fig:multiple}A.
    In this system there are two intermediate metabolites, $X_1$ and $X_2$, two reactions that form the cycle, $f_{a_1}$ and $f_{a_2}$, and two branch reactions, $f_{b_1}$ and $f_{b_2}$.
    We assume, without loss of generality, that the autocatalytic reaction (the reaction that increases the amount of carbon in the cycle) is $f_{a_2}$ and that the autocatalysis is in a $1:2$ ratio.
    The equations describing the dynamics of the system are thus:
    \begin{align*}
        \dot{X_1} & =2f_{a_2}-f_{a_1}-f_{b_1} \\
        \dot{X_2} & =f_{a_1}-f_{a_2}-f_{b_2}
    \end{align*}
    We note that in steady state, where $0=\dot{X_1}=\dot{X_2}$, it must hold that $f_{b_1}+f_{b_2}=f_{a_2}$, as the total outgoing flux must balance the total increase of intermediate metabolites due to autocatalysis.
    Given that a steady state of the system exists for some value $(X_1^*,X_2^*)$, we can evaluate the condition for stability.
    In multi-variable systems, stability dictates that the real part of the eigenvalues of the Jacobian matrix must all be negative.
    We define $\alpha_i=\frac{\partial f_{a_i}}{\partial X_i}$ and $\beta_i=\frac{\partial f_{b_i}}{\partial X_i}$ for $i=1,2$.
    We note that as we assume Michaelis Menten kinetics, $\alpha_i>0$ and $\beta_i \geq 0$, where $\beta_i=0$ is the case where there is no flux branching out at $i$.
    We then get that the Jacobian matrix is:
    \begin{equation*}
        J=
        \begin{pmatrix}
            -(\alpha_1+\beta_1) & 2\alpha_2 \\
            \alpha_1 & -(\alpha_2+\beta_2)
        \end{pmatrix}
    \end{equation*}
    Solving for the characteristic polynomial gives:
    \begin{align*}
        0 & =(\lambda+\alpha_1+\beta_1)(\lambda+\alpha_2+\beta_2)-2\alpha_1\alpha_2 \\
        & = \lambda^2+(\alpha_1+\beta_1+\alpha_2+\beta_2)\lambda+(\alpha_1+\beta_1)(\alpha_2+\beta_2)-2\alpha_1\alpha_2
    \end{align*}
    that has two negative roots when:
    \begin{equation*}
        (\alpha_1+\beta_1)(\alpha_2+\beta_2)-2\alpha_1\alpha_2>0
    \end{equation*}
    which is satisfied if $\beta_1 > \alpha_1$ or $\beta_2 > \alpha_2$.
    Therefore, if either $\beta_1 > \alpha_1$ or $\beta_2 > \alpha_2$ at the steady state, then the steady state is stable.

\begin{figure}[!htb]
  \centering
      \input{complex-autocatalytic-cycles.tex}
     \caption{
     Multiple-reaction autocatalytic cycles with a single assimilating reaction.
     (A) A two reaction system.
     (B) A generic $n$-reaction system.
     The system is at steady state when the total consumption of intermediate metabolites by the branch reactions is equal to the flux through the autocatalytic reaction.
     A sufficient condition for the stability of a steady state in these systems is that the derivative of at least one branch reaction with respect to the substrate concentration is larger than the derivative of the equivalent autocatalytic reaction at the steady state concentration.
     Given the connection between derivatives of fluxes and saturation levels of reactions (see Methods), this condition implies that a sufficient condition for the stability of a steady state is that the saturation level of at least one branch reactions is smaller than the saturation level of the corresponding autocatalytic reaction.
 }
     \label{fig:multiple}
\end{figure}

    The two-metabolites cycle case can be easily extended for a larger number of intermediate metabolites and reactions, as is depicted in figure \ref{fig:multiple}B.
    We again arbitrarily assume that the autocatalytic reaction is the last reaction, $f_{a_n}$, and that the autocatalysis is in a $1:2$ ratio.

    In this case, steady state implies that the concentration of each intermediate metabolite is conserved, meaning that for all $i>1$:
    \begin{equation}
        \label{eq:complexdecrease}
      \dot{X_i}=0 \Rightarrow f_{a_{i-1}}-f_{a_i}-f_{b_i}=0 \Rightarrow f_{a_{i-1}} \geq f_{a_i}
    \end{equation}
    (for $i=1$, as $f_{a_n}$ is the autocatalytic reaction, we get that $2*f_{a_{n}} \geq f_{a_1}$).
    Also, because at steady state the total outgoing flux from the cycle must balance the total incoming flux into the system, which is the amount of autocatalysis carried out by $f_{a_n}$, we get that:
    \begin{equation*}
      \sum_{i=1}^n f_{b_i}=f_{a_n}
  \end{equation*}
implying that for all $i$:
    \begin{equation}
        \label{eq:complexsmallbranch}
        f_{b_i} \leq f_{a_n}
  \end{equation}

    Deriving stability criterion for the multiple-reaction case, we get that in this case a steady state is stable if there exists $i$ such that $\beta_i > \alpha_i$ (see methods).

    To conclude, for the straightforward extension of the simple model to multiple reactions with a single autocatalytic reaction, steady state implies that for all $i$:
    \begin{equation}
        f_{b_i} \leq f_{a_n} \leq f_{a_i}
      \label{eq:complexstst}
    \end{equation}
    Where the left inequality is due to Equation \ref{eq:complexsmallbranch} and the right inequality is due to Equation \ref{eq:complexdecrease}.

    A sufficient condition for such a steady state point to be stable is that at the steady state point there exists at least one branching point $i$ at which the derivative of the branch reaction is larger than the derivative of the equivalent autocatalytic reaction:
    \begin{equation}
      \beta_i > \alpha_i
      \label{eq:complexstab}
    \end{equation}
    Using the connection between derivatives of reactions and saturation levels (see Methods), we conclude that a sufficient condition for stable autocatalytic fluxes is that the saturation of a single branch reaction, denoted $S(f)$, will be lower than the saturation of the corresponding autocatalytic reaction:
    \begin{equation}
        S(f_{b_i}) < S(f_{a_i})
      \label{eq:complexsat}
    \end{equation}
    This condition also dictates that the affinity of the branch reaction to the intermediate metabolite of the cycle it consumes must be lower than the affinity of the corresponding recycling reaction of the cycle.
    \subsubsection{Using different kinetics equations}
    Although we utilized the widely-used irreversible Michaelis-Menten kinetics equation to model enzyme kinetics, our results can be extended to different kinetic equations.
    Generally, two conditions must be met for a stable flux through an autocatalytic cycle to exist: (A) there should be a positive concentration of the intermediate metabolites for which the outgoing fluxes balance the autocatalytic fluxes, resulting in a steady state of fluxes, and, (B) at the steady state point at least one derivative of an outgoing reaction out of the cycle should be higher than the derivative of the corresponding autocatalytic reaction, as is implied by equation \ref{eq:complexstab}, to enforce stability in the presence of small perturbations.
    Therefore, these two conditions should be explicitly evaluated for every case with different kinetic equations and autocatalytic cycles topologies to assert whether it can carry stable fluxes or not.

    \subsection{Testing the predictions of the analysis with experimental data on functioning autocatalytic cycles}
    To evaluate the validity of our analysis of autocatalytic cycles we searched for growth conditions under which the autocatalytic cycles we identified in central carbon metabolism carry substantial flux in-vivo.
    We used recent in-vivo flux measurements in \emph{E.coli} from \cite{Gerosa2015-oq}.
    According to the data, two autocatalytic cycles carry substantial flux under at least one of the growth conditions measured:
    a cycle using the PTS transport system carries significant fluxes in growth on glucose and on fructose;
    the glyoxylate cycle carries significant flux in growth on galactose and on acetate.

    As noted above, we predict a key design principle for functioning autocatalytic cycles: that at least one branch reaction should be less saturated than the corresponding autocatalytic reaction.
    This requirement is sufficient, but not necessary, for the autocatalytic cycle to be at a stable steady state point.
    To evaluate the saturation level of a reaction under a given condition, two values must be obtained:
    \begin{enumerate}
      \item The maximal flux capacity of the reaction under the given condition, $V_{\max}$.
        \item The actual flux through the reaction at the steady state, $f$.
    \end{enumerate}

    To estimate the maximal capacity of a reaction we followed the procedure described in \cite{Davidi2016-ga} (see methods).
    We used the data from \cite{Gerosa2015-oq} to identify the major branch points in each functioning cycle and the flux distributions in them under each of the relevant conditions.
    The results are presented in figure \ref{fig:branch}.

\begin{figure}[!htb]
\centering
\resizebox{1\linewidth}{!}{
    \input{experimental-fluxes.tex}
}
\caption{
  Major branch points and relative enzyme saturation in operating autocatalytic cycles.
  Solid arrow width represents carbon flux per unit time.
  Shaded arrow width represents maximal carbon flux capacity per unit time, given the expression level of the catalyzing enzyme.
  In all cases there is enough excess capacity in the branching reactions to prevent the cycle from overflowing.
  A $4\%$ flux from pep to biomass was neglected in growth under glucose and fructose.
  Only in one out of the 9 branch points observed (the branch point at fbp in growth under fructose), the outgoing reaction is significantly more saturated than the autocatalytic reaction.
  (*) A branch point at which the branching reaction is more saturated than the autocatalytic reaction, which may result from neglecting fructose transport directly as f6p when deriving fluxes (see text).
}
    \label{fig:branch}
\end{figure}

    Our results show that for any of the 4 functioning autocatalytic cycle cases, in at least one branch point the biomass generating branch reaction has a larger maximal flux capacity, and is considerably less saturated than the respective autocatalytic reaction, in accordance with our predictions.
    Moreover, out of 9 branch points analyzed, in 6 branch points the branching reactions were significantly less saturated than the autocatalytic reactions, in 2 branch points the saturation levels were similar, and only in one branch point the autocatalytic reaction was less saturated than the branching reaction.

    The branch point at which the autocatalytic reaction is less saturated than the branch reaction is the branch point from fructose-1,6-bisphosphate in growth on fructose as the carbon source.
    The high saturation of the branch reaction arises as a large flux is reported for the fbp reaction, whereas the corresponding enzyme is not highly expressed under this condition.
    The large reported flux through fbp arises due to assuming a single transport pathway for fructose, entering the cycle as fructose-1,6-bisphosphate.
    However, an alternative fructose transport pathway is known to occur in the concentration at which the measurements were made \cite{Kornberg1990-ft}.
    The alternative transport pathway produces fructose-6-phosphate from external fructose.
    Therefore, any flux through the alternative transport pathway should be directly deduced from the flux through fbp.
    Assuming $20\%$ of the consumed fructose uses this pathway suffices in order to balance the saturation levels at the fructose-1,6-bisphosphate branch point.

    The consistently lower saturation values of biomass generating branch reactions demonstrate that the expressed enzymes have enough capacity to prevent the autocatalytic cycle from increasing the concentration of intermediate metabolites infinitely.
    Moreover, the lower saturation values of the biomass generating reactions suggest that at the steady state point their derivatives are higher, ensuring stable operation of the cycle.

    Another demonstration of the autocatalytic mechanism being at play is in the CBB cycle, which is not a part of the metabolic network of wild type \emph{E.coli}, and for which no flux measurements are available.
    This cycle has been recently introduced synthetically into \emph{E.coli} and was shown to carry flux in it, given further metabolic engineering of central carbon metabolism \cite{Antonovsky2016-jy}.
    The experimentally observed key evolutionary event enabling the functioning of the CBB cycle, was a mutation affecting the kinetic properties of the main branching reaction out of the CBB pathway, PRS, reducing its affinity to its substrate, ribose-5p.
    The observed reduction in affinity of PRS is directly in line with our predictions on the relationship between the affinity of branch reactions and the affinity of the corresponding autocatalytic reactions.

    The other examples of autocatalytic cycles we found did not carry flux in any of the conditions for which data was available.
    The penthose-phosphate cycle variants do not carry flux in any of the measured conditions, which is expected given that growth on ribose was not measured.
    The gluconeogenic FBA with ED pathway cycle also did not carry flux in any of the measured conditions.
    Although glycerol could have been a potential carbon source to use this pathway, the metabolic network allows for a more energy efficient growth by using the tpi reaction, as was indeed observed.

    To conclude, existing data supports predictions made by our model, given the requirement for stable steady state operation of autocatalytic cycles.
    This agreement between predictions and measurements is especially encouraging given the highly limited information on kinetic properties, concentrations, and fluxes under various growth conditions.

\section{Discussion}
Our study into the dynamics and stability of autocatalytic cycles suggests design principles applicable to both synthetic biology, in the effort to express novel heterologous cycles, and in the context of systems biology that aims to understand the function of natural networks.

Our autocatalytic modeling framework gives concrete predictions on saturation levels of branch reactions for operating autocatalytic cycles.
We find these predictions agree well with empirically measured fluxomics and proteomics data sets.
    The model can be used to shed light on seemingly wasteful investment in the expression of enzymes whose capacity is not fully utilized.
    The model can also highlight metabolic branch points at which the kinetic efficiency of  enzymes is constrained due to stability requirements of a corresponding autocatalytic cycle.

A common concept in synthetic biology is that the successful implementation of novel pathways requires the expression of functional enzymes in the correct amounts in the target organism.
Here we show that in the context of autocatalytic cycles, such expression modulation may not suffice.
Specifically, changes to the substrate affinity of enzymes at branch points of the cycle may be required in order for the novel pathway to function.

Another aspect of our findings is that while it is common to assume that high affinity and catalytic rate are desirable traits for enzymes, such seeming improvements may actually lead to instability and thus to non functional metabolic cycles.
Furthermore, for reactions branching out of autocatalytic cycles, lower affinities increase the steady state concentration of intermediate metabolites, resulting in higher fluxes both through the cycle, and through the branch reaction, suggesting an unconventional strategy for optimizing fluxes through such reactions.

An experimental demonstration of these principles in-vivo is the recent implementation of a functional CBB cycle in \emph{E.coli} by introducing the two genes missing for its function \cite{Antonovsky2016-jy}.
The successful introduction of the genes did not suffice to make the cycle function, and further directed evolution was needed in order to achieve successful operation of the cycle.
Strikingly, most evolutionary changes occurred in branch points from the cycle.
The change which was biochemically characterized in the evolutionary process was the decrease of the value of $\sfrac{k_{\text{cat}}}{K_M}$ of phosphoribosylpyrophosphate synthetase (PRS), one of the enzymes responsible for flux out of the CBB cycle, corresponding to the branch reaction in our simple model.
This is beautifully in line with the predictions of our analysis that suggest that decreasing $\sfrac{V_{\max}}{K_M}$ of branch reactions can lead to the existence of a stable flux solution.

Our observation regarding the stabilizing effect of input fluxes into an autocatalytic cycle can provide means to mitigate the stability issue in synthetic biology metabolic engineering setups.
In such setups, conducting directed evolution under gradually decreasing input fluxes allows for a pathway to gradually evolve towards sustainable, substantial flux.
This observation may also highlight the importance of seemingly redundant reactions such the one catalyzed by rpi, in growth on ribose.

While autocatalytic cycles are usually considered a small part of metabolism, we find that such cycles are at the heart of central carbon metabolism.
We use recent measurements to support our predictions on the usage of enzymes catalyzing reactions branching out of such cycles.
Our observations suggest that the constraints we find on the kinetic parameters of enzymes involved in autocatalytic cycles may limit the parameters of a broad set of enzymes central to metabolism.

  Finally, while our work focuses on cycles increasing the amount of carbon in the system, we note that autocatalysis can be defined with respect to other quantities such as energy (e.g. ATP investment and production in glycolysis), non-carbon atoms, reducing power, or other moieties \cite{Reich1981-qd}.
  The analysis we present here can thus be of wide relevance for the design and analysis of metabolic networks.

  \section{Methods}
  \subsection{Formal definition of an autocatalytic metabolic cycle}
  Given a metabolic network composed of a set of reactions and metabolites, the following criteria can be used to define a subset of the network that is an autocatalytic cycle:
A set of irreversible reactions (for reversible reactions only one direction can be included in the set) and metabolites forms a cycle if every metabolite of the set can be converted, by sequential application of reactions in the set (where two reactions can be chained if a metabolite in the set is a product of the first reaction and a substrate of the second reaction), to every other metabolite in the set.
A cycle is autocatalytic if the reactions of the cycle can be applied, each reaction at an appropriate, positive number of times, such that the resulting change in the amount of each of the metabolites forming the cycle is non-negative, with at least one metabolite of the cycle having a strictly positive change.

The same definition can be stated in terms of reaction vectors and a stoichiometric matrix.
If a metabolic network has $n$ metabolites, indicated by the numbers $1$ to $n$, then every reaction, $R$, in the network can be described as a vector $V_R$ in $\mathbb{Z}^n$, such that the $i$'th coordinate of $V_R$ specifies how much of metabolite $i$ the reaction $R$ produces (if $R$ consumes a metabolite, then the value at the coordinate representing the metabolite is negative).

With this notation, a set of metabolites: $M'={m_1\cdots m_j}$ and a set of reactions, $R'={r_1\cdots r_k}$ form an autocatalytic cycle if:
\begin{enumerate}
    \item Every metabolite in $M'$ is a substrate of at least one reaction in $R'$, and a product of at least one reaction in $R'$.
    \item Every reaction in $R'$ has at least one substrate from $M'$ and at least one product from $M'$.
    \item There is a set of positive integers, $i_1\cdots i_k$ such that the total reaction vector $R^*=\sum_{l=1}^k i_lR_l$ is non negative at all the coordinates $m_1\cdots m_j$ and is strictly positive for at least one coordinate in this range.
\end{enumerate}

  \subsection{Systematic identification of autocatalytic cycles in metabolic networks}
  We implemented an algorithm to systematically search for autocatalytic cycles in metabolic networks.
  The algorithm is incomplete, meaning there may be autocatalytic cycles that will not be identified by it.
  Further work will enable a more robust algorithm to identify additional autocatalytic cycles in full metabolic networks.
  We used the algorithm on the core carbon metabolism network of \emph{E.coli} \cite{Orth2010-vl}.

  In our framework, a metabolic network is defined by a set of reactions, $(\bar{R})$.
  Each reaction is defined by a set of substrates and a set of products, with corresponding stoichiometries $R_i=(S,P,N^S,N^P)$, such that $R_i$ describes the reaction $\sum_j N_j^SS_j \rightarrow \sum_k N_k^PP_k$.
  The algorithm works as follows:
  \begin{enumerate}
    \item All co-factors are removed from the description of the metabolic network, so that it is carbon-based.
    \item The metabolic network is converted to a directed graph, G:
  The nodes of G are all the metabolites and all the reactions of the network.
  For each metabolite, $M$, and each reaction, $R$, if $M$ is a substrate of $R$ then the edge $(M,R)$ is added to the graph, and if $M$ is a product of $R$, then the edge $(R,M)$ is added to the graph.
    \item The Tarjan cycle identification algorithm is used to enumerate all the cycles in the graph \cite{Tarjan1973-gn}.
    \item for every cycle identified by the Tarjan algorithm, $C$, the algorithm checks if the cycle can be the backbone of an autocatalytic cycle as follows:
        \begin{enumerate}
            \item For every reaction in the cycle, $R$, the algorithm checks if it consumes more than one  intermediate metabolite of the cycle.
              If so, $C$ is assumed not to be autocatalytic and the algorithm continues to evaluate the next cycle.
            \item Otherwise, for every reaction in the cycle, $R$, the algorithm checks if it has more than one product that is an intermediate metabolite of the cycle.
              If so, then the algorithm lists $C$ as an autocatalytic cycle.
            \item Finally, the algorithm checks, for every reaction in the cycle, if it has a product that is not an intermediate metabolite of the cycle.
                If so, denote by $M_E$ such a metabolite.
            The algorithm proceeds to check if, for every intermediate metabolite of the cycle, $M_i$ a reaction exists from $M_E$ to $M_i$ that does not use any of the reactions of the cycle, and does not consume any of the intermediate metabolites of the cycle.
            If so then the algorithm lists $C$ as an autocatalytic cycle.
        \end{enumerate}
  \end{enumerate}

  The algorithm assumes reactions consume exactly one molecule of any of their substrates and produce exactly one molecule of any of their products, an assumption that holds for the core model of \emph{E.coli}, but not in metabolic networks in general.
  
  \subsection{Limits on derivatives of branch reactions for complex autocatalytic cycles}
  Stability analysis of a model complex autocatalytic cycle with $n$ reactions in the cycle results in the following Jacobian matrix:
  \begin{equation*}
    J=
    \begin{pmatrix}
        -(\alpha_1+\beta_1) & 0 & \cdots & 0 & 2\alpha_n \\
        \alpha_1 & -(\alpha_2+\beta_2) & \cdots & 0 & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \cdots & -(\alpha_{n-1}+\beta_{n-1}) & 0\\
        0 & 0 & \cdots & \alpha_{n-1} & -(\alpha_n+\beta_n)
     \end{pmatrix}
  \end{equation*}
   The characteristic polynomial of this matrix is given by:
    \begin{equation}
        \label{eq:complex}
        0=\prod_{i=1}^n(\lambda+\alpha_i+\beta_i)-2\prod_{i=1}^n\alpha_i
    \end{equation}

  To extract the conditions under which all the roots of the characteristic polynomial have negative real parts we use Rouche's theorem.
  Our strategy will be as follows:
  We will define a contour that contains only numbers with negative real parts.
  We will show that all the roots of the polynomial $0=\prod_{i=1}^n(\lambda+\alpha_i+\beta_i)$ lie within the area this contour encloses.
  We will find the conditions for which  $|\prod_{i=1}^n(\lambda+\alpha_i+\beta_i)|>2\prod_{i=1}^n\alpha_i$ on the contour, satisfying the premise of Rouche's theorem.
  We will then claim that under these conditions all the roots of the polynomial in Equation \ref{eq:complex} must also lie inside the contour, and therefore must have negative real parts.
  Given that all the roots of this polynomial have negative real parts, we will conclude that the eigenvalues of the Jacobian matrix at the steady state point all have negative real parts, making the steady state point stable.

  \paragraph{Proof:} We pick a large parameter $R$, such that $R>3\max_j(\alpha_j+\beta_j)$.
  We look at the closed half circle contour, $K$, composed of the segment $[(0,-iR),(0,iR)]$ and the half circle arc $(x,iy)$ such that $x\leq 0$ and $x^2+y^2=R^2$.
  We define 
  \begin{equation*}
      g(\lambda)=2\prod_{j=1}^n\alpha_j
  \end{equation*}
  noting that it is constant over all of $\mathbb{C}$ and specifically over $K$.
  We define
  \begin{equation*}
      f(\lambda)=\prod_{j=1}^n(\lambda+\alpha_j+\beta_j)
  \end{equation*}
  noting that all of $f$'s roots lie inside $K$ as the roots are $0>-(\alpha_j+\beta_j)>-R$ for all $j$.
  We check the conditions under which $|f(\lambda)|>|g(\lambda)|$ over the contour $K$.

  For the arc segment we note that, as for complex numbers it holds that $|xy|=|x||y|$, then
  \begin{equation*}
      |f(\lambda)|=\prod_{j=1}^n|\lambda+\alpha_j+\beta_j|
  \end{equation*}
  From the triangle inequality we know that $|x+y| \geq |x|-|y|$ and therefore for all $j$ it holds that
  \begin{equation*}
      |\lambda+\alpha_j+\beta_j| \geq R-(\alpha_j+\beta_j)
  \end{equation*}
  As we picked $R$ such that $R>3\max_j(\alpha_j+\beta_j)$ we get that 
  \begin{equation*}
      R-(\alpha_j+\beta_j)>2(\alpha_j+\beta_j)
  \end{equation*}
  and therefore 
  \begin{equation*}
      \prod_{j=1}^n|\lambda+\alpha_j+\beta_j|>\prod_{j=1}^n2|\alpha_j+\beta_j|>\prod_{j=1}^n2|\alpha_j| = |g(\lambda)|
  \end{equation*}
  concluding that over the arc, $|f(\lambda)|>|g(\lambda)|$.

  For the part of $K$ on the imaginary axis we note that $\lambda=iy$ where $y\in[-R,R]$.
For this segment we therefore get that
\begin{equation*}
    |f(\lambda)|=\prod_{j=1}^n|\alpha_j+\beta_j+iy|=\sqrt{\prod_{j=1}^n((\alpha_j+\beta_j)^2+y^2)} \geq \sqrt{\prod_{j=1}^n(\alpha_j+\beta_j)^2}
 \end{equation*} 
 and, as before, that
 \begin{equation*}
     |g(\lambda)|=2\sqrt{\prod_{j=1}^n\alpha_j^2}
 \end{equation*}
 To meet the condition that $|f(\lambda)|>|g(\lambda)|$, which is equivalent to: $\frac{|f(\lambda)|}{|g(\lambda)|}>1$, it is sufficient to find the conditions under which:
 \begin{equation*}
   \frac{\sqrt{\prod_{j=1}^n(\alpha_j+\beta_j)^2}}{2\sqrt{\prod_{j=1}^n\alpha_j^2}}>1
 \end{equation*}
 Simplifying this inequality gives:
 \begin{equation*}
     \frac{1}{2}\sqrt{\prod_{j=1}^n\frac{(\alpha_j+\beta_j)^2}{\alpha_j^2}}= \frac{1}{2}\prod_{j=1}^n\frac{\alpha_j+\beta_j}{\alpha_j}= \frac{1}{2}\prod_{j=1}^n(1+\frac{\beta_j}{\alpha_j})>1 \Rightarrow \prod_{j=1}^n(1+\frac{\beta_j}{\alpha_j})>2
 \end{equation*}
 A sufficient condition to satisfy this inequality, given that all the $\alpha_j$ are positive and all the $\beta_j$'s are non negative, is that there exists $j$ such that $\beta_j > \alpha_j$.

 We therefore get that if there exists $j$ such that  $\beta_j > \alpha_j$, then $|f(\lambda)|>|g(\lambda)|$ over the contour $K$.
 In this case, by Rouche's theorem, we deduce that, as all of $f$'s roots lie inside $K$, then it follows that all of $f-g$'s roots lie inside $K$, concluding that the real part of all of the eigen values of the characteristic polynomial of the jacobian matrix of the complex autocatalytic cycle are negative, making any steady state that meets this criterion stable.

    \subsection{The relationship between derivatives in Michaelis-Menten kinetics dictates an inverse relationship between affinities and saturation levels}
    It turns out that for the Michaelis-Menten kinetics equations, the following useful lemma can be used to connect theoretical observations on the relationships of derivatives to physiological observations on affinities and saturation levels.

    We define the saturation level of a reaction as the ratio between the flux it carries, and the maximal flux it can carry, given the expression level of the relevant enzyme, that is:
    \begin{equation*}
      S(X)=\frac{f(X)}{V_{\max}}=\frac{X}{K_M+X}
    \end{equation*}

    Given this definition we can show that if two Michaelis-Menten reactions consume the same metabolite, $X$, and at a given concentration, $X^*$, it holds that $f_a(X^*)\geq f_b(X^*)$, then if:
    \begin{equation}
        \frac{df_b}{dX}\Big\vert_{X^*}>\frac{df_a}{dX}\Big\vert_{X^*}
        \label{eq:lemmapremise}
    \end{equation}
    then it follows that:
    \begin{equation*}
    \begin{dcases}
      & K_{M,b}>K_{M,a} \\
      & S_b(X^*)<S_a(X^*)
    \end{dcases}
    \end{equation*}
    Proof: expanding the condition that $f_a(X^*)\geq f_b(X^*)$, we get that:
    \begin{equation}
        \frac{V_{\max,b}X^*}{K_{M,b}+X^*}\leq\frac{V_{\max,a}X^*}{K_{M,a}+X^*} \Rightarrow
         \frac{V_{\max,b}}{K_{M,b}+X^*}\leq\frac{V_{\max,a}}{K_{M,a}+X^*}
         \label{eq:firstmid}
     \end{equation}
     Expanding the premise of the lemma in equation \ref{eq:lemmapremise} gives us that:
     \begin{equation*}
        \frac{df_b}{dX}\Big\vert_{X^*}>\frac{df_a}{dX}\Big\vert_{X^*} \Rightarrow
        \frac{V_{\max,b}K_{M,b}}{(K_{M,b}+X^*)^2} > \frac{V_{\max,a}K_{M,a}}{(K_{M,a}+X^*)^2}
     \end{equation*}
     Because equation \ref{eq:firstmid} holds, it follows that:
     \begin{equation*}
         \frac{K_{M,b}}{K_{M,b}+X^*} > \frac{K_{M,a}}{K_{M,a}+X^*} \Rightarrow \frac{1}{1+\frac{X^*}{K_{M,b}}} > \frac{1}{1+\frac{X^*}{K_{M,a}}} \Rightarrow K_{M,b}>K_{M,a}
     \end{equation*}
    setting the affinity of the autocatalytic enzyme as a lower bound for the affinity of the branch enzyme.
    Finally, given this relation of affinities it follows that:
    \begin{equation*}
        K_{M,b}>K_{M,a} \Rightarrow X^*+K_{M,b}>X^*+K_{M,a} \Rightarrow \frac{X^*}{X^*+K_{M,b}}<\frac{X^*}{X^*+K_{M,a} } \Rightarrow S_b(X^*)<S_a(X^*)
    \end{equation*}
    concluding the proof.

    We note that a multiple reaction autocatalytic cycle at a stable steady state point satisfies equations \ref{eq:complexstst} and \ref{eq:complexstab}, so the lemma applies.

    \subsection{Evaluating maximal flux capacity of reactions under a given condition}
    To evaluate the maximal flux capacity of a reaction under a given growth condition, given expression level and flux data for a set of conditions, we follow the procedure described in \cite{Davidi2016-ga}.
    For each reaction, under every condition, we divide the flux the reaction carries (obtained from \cite{Gerosa2015-oq}) by the amount of the corresponding enzyme expressed under that condition (obtained from \cite{Schmidt2015}).
    We thus get a flux per enzyme estimate for the given reaction under each of the conditions.
    We define the enzyme maximal in-vivo catalytic rate as the maximum flux per unit enzyme it carries across all conditions (noting that this is actually only a lower bound on this rate).
    Multiplying the enzyme maximal catalytic rate by the enzyme amount at each condition therefore results in an estimate of the maximal possible flux through the given reaction under the relevant condition.
